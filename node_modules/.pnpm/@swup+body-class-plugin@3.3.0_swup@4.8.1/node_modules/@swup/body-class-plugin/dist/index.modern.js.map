{"version":3,"file":"index.modern.js","sources":["../src/classes.ts","../src/attributes.ts","../src/index.ts"],"sourcesContent":["export function updateClassNames(el: HTMLElement, newEl: HTMLElement, { prefix = '' } = {}): void {\n\tconst remove = [...el.classList].filter((className) => isValid(className, { prefix }));\n\tconst add = [...newEl.classList].filter((className) => isValid(className, { prefix }));\n\tel.classList.remove(...remove);\n\tel.classList.add(...add);\n}\n\nfunction isValid(className: string, { prefix = '' } = {}): boolean {\n\treturn !!className && className.startsWith(prefix);\n}\n","export function updateAttributes(\n\ttarget: Element,\n\tsource: Element,\n\tfilters: (string | RegExp)[] = []\n): void {\n\tconst keep = new Set<string>();\n\n\tfor (const { name, value } of getAttributes(source, filters)) {\n\t\ttarget.setAttribute(name, value);\n\t\tkeep.add(name);\n\t}\n\n\tfor (const { name } of getAttributes(target, filters)) {\n\t\tif (!keep.has(name)) {\n\t\t\ttarget.removeAttribute(name);\n\t\t}\n\t}\n}\n\nfunction getAttributes(el: Element, filters: (string | RegExp)[] = []): Attr[] {\n\tconst all = Array.from(el.attributes);\n\tif (!filters.length) return all;\n\n\treturn all.filter(({ name }) =>\n\t\tfilters.some((pattern) =>\n\t\t\tpattern instanceof RegExp ? pattern.test(name) : name === pattern\n\t\t)\n\t);\n}\n","import { Handler } from 'swup';\nimport Plugin from '@swup/plugin';\nimport { updateClassNames } from './classes.js';\nimport { updateAttributes } from './attributes.js';\n\ntype Options = {\n\t/** If set, only classes beginning with this string will be added/removed. */\n\tprefix: string;\n\t/** Additional body attributes to update, besides the classname. */\n\tattributes: (string | RegExp)[];\n};\n\nexport default class SwupBodyClassPlugin extends Plugin {\n\tname = 'SwupBodyClassPlugin';\n\n\trequires = { swup: '>=4.6' };\n\n\tdefaults: Options = {\n\t\tprefix: '',\n\t\tattributes: []\n\t};\n\toptions: Options;\n\n\tconstructor(options: Partial<Options> = {}) {\n\t\tsuper();\n\t\tthis.options = { ...this.defaults, ...options };\n\t}\n\n\tmount() {\n\t\tthis.on('content:replace', this.update);\n\t}\n\n\tprotected update: Handler<'content:replace'> = (visit) => {\n\t\tconst { prefix, attributes } = this.options;\n\t\tupdateClassNames(document.body, visit.to.document!.body, { prefix });\n\t\tif (attributes?.length) {\n\t\t\tupdateAttributes(document.body, visit.to.document!.body, attributes);\n\t\t}\n\t};\n}\n"],"names":["isValid","className","prefix","startsWith","getAttributes","el","filters","all","Array","from","attributes","length","filter","name","some","pattern","RegExp","test","SwupBodyClassPlugin","Plugin","constructor","options","super","this","requires","swup","defaults","update","visit","newEl","remove","classList","add","updateClassNames","document","body","to","target","source","keep","Set","value","setAttribute","has","removeAttribute","updateAttributes","_extends","mount","on"],"mappings":"gQAOA,SAASA,EAAQC,GAAmBC,OAAEA,EAAS,IAAO,CAAA,GACrD,QAASD,GAAaA,EAAUE,WAAWD,EAC5C,CCUA,SAASE,EAAcC,EAAaC,EAA+B,IAClE,MAAMC,EAAMC,MAAMC,KAAKJ,EAAGK,YAC1B,OAAKJ,EAAQK,OAENJ,EAAIK,OAAO,EAAGC,UACpBP,EAAQQ,KAAMC,GACbA,aAAmBC,OAASD,EAAQE,KAAKJ,GAAQA,IAASE,IAJhCR,CAO7B,CChBqB,MAAAW,UAA4BC,EAWhDC,WAAAA,CAAYC,EAA4B,CAAA,GACvCC,QAAQC,KAXTV,KAAO,sBAAqBU,KAE5BC,SAAW,CAAEC,KAAM,cAEnBC,SAAoB,CACnBxB,OAAQ,GACRQ,WAAY,IACZa,KACDF,aAAO,EAAAE,KAWGI,OAAsCC,IAC/C,MAAM1B,OAAEA,EAAMQ,WAAEA,GAAea,KAAKF,SFjCtB,SAAiBhB,EAAiBwB,GAAoB3B,OAAEA,EAAS,IAAO,CAAE,GACzF,MAAM4B,EAAS,IAAIzB,EAAG0B,WAAWnB,OAAQX,GAAcD,EAAQC,EAAW,CAAEC,YACtE8B,EAAM,IAAIH,EAAME,WAAWnB,OAAQX,GAAcD,EAAQC,EAAW,CAAEC,YAC5EG,EAAG0B,UAAUD,UAAUA,GACvBzB,EAAG0B,UAAUC,OAAOA,EACrB,CE6BEC,CAAiBC,SAASC,KAAMP,EAAMQ,GAAGF,SAAUC,KAAM,CAAEjC,WACvDQ,MAAAA,GAAAA,EAAYC,QDnCF,SACf0B,EACAC,EACAhC,EAA+B,IAE/B,MAAMiC,EAAO,IAAIC,IAEjB,IAAK,MAAM3B,KAAEA,EAAI4B,MAAEA,KAAWrC,EAAckC,EAAQhC,GACnD+B,EAAOK,aAAa7B,EAAM4B,GAC1BF,EAAKP,IAAInB,GAGV,IAAK,MAAMA,KAAEA,KAAUT,EAAciC,EAAQ/B,GACvCiC,EAAKI,IAAI9B,IACbwB,EAAOO,gBAAgB/B,EAG1B,CCmBGgC,CAAiBX,SAASC,KAAMP,EAAMQ,GAAGF,SAAUC,KAAMzB,EAC1D,EAZAa,KAAKF,QAAOyB,EAAA,CAAA,EAAQvB,KAAKG,SAAaL,EACvC,CAEA0B,KAAAA,GACCxB,KAAKyB,GAAG,kBAAmBzB,KAAKI,OACjC"}