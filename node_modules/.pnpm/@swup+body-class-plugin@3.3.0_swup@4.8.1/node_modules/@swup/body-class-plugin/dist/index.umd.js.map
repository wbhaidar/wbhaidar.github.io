{"version":3,"file":"index.umd.js","sources":["../node_modules/@swup/plugin/dist/index.modern.js","../src/classes.ts","../src/attributes.ts","../src/index.ts"],"sourcesContent":["function r(){return r=Object.assign?Object.assign.bind():function(r){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])}return r},r.apply(this,arguments)}const n=r=>String(r).split(\".\").map(r=>String(parseInt(r||\"0\",10))).concat([\"0\",\"0\"]).slice(0,3).join(\".\");class e{constructor(){this.isSwupPlugin=!0,this.swup=void 0,this.version=void 0,this.requires={},this.handlersToUnregister=[]}mount(){}unmount(){this.handlersToUnregister.forEach(r=>r()),this.handlersToUnregister=[]}_beforeMount(){if(!this.name)throw new Error(\"You must define a name of plugin when creating a class.\")}_afterUnmount(){}_checkRequirements(){return\"object\"!=typeof this.requires||Object.entries(this.requires).forEach(([r,e])=>{if(!function(r,e,t){const s=function(r,n){var e;if(\"swup\"===r)return null!=(e=n.version)?e:\"\";{var t;const e=n.findPlugin(r);return null!=(t=null==e?void 0:e.version)?t:\"\"}}(r,t);return!!s&&((r,e)=>e.every(e=>{const[,t,s]=e.match(/^([\\D]+)?(.*)$/)||[];var o,i;return((r,n)=>{const e={\"\":r=>0===r,\">\":r=>r>0,\">=\":r=>r>=0,\"<\":r=>r<0,\"<=\":r=>r<=0};return(e[n]||e[\"\"])(r)})((i=s,o=n(o=r),i=n(i),o.localeCompare(i,void 0,{numeric:!0})),t||\">=\")}))(s,e)}(r,e=Array.isArray(e)?e:[e],this.swup)){const n=`${r} ${e.join(\", \")}`;throw new Error(`Plugin version mismatch: ${this.name} requires ${n}`)}}),!0}on(r,n,e={}){var t;n=!(t=n).name.startsWith(\"bound \")||t.hasOwnProperty(\"prototype\")?n.bind(this):n;const s=this.swup.hooks.on(r,n,e);return this.handlersToUnregister.push(s),s}once(n,e,t={}){return this.on(n,e,r({},t,{once:!0}))}before(n,e,t={}){return this.on(n,e,r({},t,{before:!0}))}replace(n,e,t={}){return this.on(n,e,r({},t,{replace:!0}))}off(r,n){return this.swup.hooks.off(r,n)}}export{e as default};\n//# sourceMappingURL=index.modern.js.map\n","export function updateClassNames(el: HTMLElement, newEl: HTMLElement, { prefix = '' } = {}): void {\n\tconst remove = [...el.classList].filter((className) => isValid(className, { prefix }));\n\tconst add = [...newEl.classList].filter((className) => isValid(className, { prefix }));\n\tel.classList.remove(...remove);\n\tel.classList.add(...add);\n}\n\nfunction isValid(className: string, { prefix = '' } = {}): boolean {\n\treturn !!className && className.startsWith(prefix);\n}\n","export function updateAttributes(\n\ttarget: Element,\n\tsource: Element,\n\tfilters: (string | RegExp)[] = []\n): void {\n\tconst keep = new Set<string>();\n\n\tfor (const { name, value } of getAttributes(source, filters)) {\n\t\ttarget.setAttribute(name, value);\n\t\tkeep.add(name);\n\t}\n\n\tfor (const { name } of getAttributes(target, filters)) {\n\t\tif (!keep.has(name)) {\n\t\t\ttarget.removeAttribute(name);\n\t\t}\n\t}\n}\n\nfunction getAttributes(el: Element, filters: (string | RegExp)[] = []): Attr[] {\n\tconst all = Array.from(el.attributes);\n\tif (!filters.length) return all;\n\n\treturn all.filter(({ name }) =>\n\t\tfilters.some((pattern) =>\n\t\t\tpattern instanceof RegExp ? pattern.test(name) : name === pattern\n\t\t)\n\t);\n}\n","import { Handler } from 'swup';\nimport Plugin from '@swup/plugin';\nimport { updateClassNames } from './classes.js';\nimport { updateAttributes } from './attributes.js';\n\ntype Options = {\n\t/** If set, only classes beginning with this string will be added/removed. */\n\tprefix: string;\n\t/** Additional body attributes to update, besides the classname. */\n\tattributes: (string | RegExp)[];\n};\n\nexport default class SwupBodyClassPlugin extends Plugin {\n\tname = 'SwupBodyClassPlugin';\n\n\trequires = { swup: '>=4.6' };\n\n\tdefaults: Options = {\n\t\tprefix: '',\n\t\tattributes: []\n\t};\n\toptions: Options;\n\n\tconstructor(options: Partial<Options> = {}) {\n\t\tsuper();\n\t\tthis.options = { ...this.defaults, ...options };\n\t}\n\n\tmount() {\n\t\tthis.on('content:replace', this.update);\n\t}\n\n\tprotected update: Handler<'content:replace'> = (visit) => {\n\t\tconst { prefix, attributes } = this.options;\n\t\tupdateClassNames(document.body, visit.to.document!.body, { prefix });\n\t\tif (attributes?.length) {\n\t\t\tupdateAttributes(document.body, visit.to.document!.body, attributes);\n\t\t}\n\t};\n}\n"],"names":["n","r","String","split","map","parseInt","concat","slice","join","e","every","t","s","match","o","i","localeCompare","numeric","isValid","className","_temp2","prefix","startsWith","getAttributes","el","filters","all","Array","from","attributes","length","filter","_ref","name","some","pattern","RegExp","test","Plugin","constructor","options","super","this","requires","swup","defaults","update","visit","newEl","_temp","remove","classList","add","updateClassNames","document","body","to","target","source","keep","Set","value","setAttribute","has","removeAttribute","updateAttributes","mount","on"],"mappings":"0cAGO,MAAMA,EAAoBC,GACzBC,OAAOD,GACZE,MAAM,KACNC,IAAIH,GAAWC,OAAOG,SAASJ,GAAW,IAAK,MAC/CK,OAAO,CAAC,IAAK,MACbC,MAAM,EAAG,GACTC,KAAK,KAAA,0nBAiCwB,EAACP,EAAmBQ,IAC5CA,EAAaC,MAAOD,IAC1B,MAASE,CAAAA,EAAYC,GAAWH,EAASI,MAAM,mBAAqB,GA/BxC,IAACC,EAAWC,EAiCxC,MA1BsB,EAACd,EAA0BD,KAClD,MAAMS,EAAc,CACnB,GAAKR,GAAoB,IAANA,EACnB,IAAMA,GAAcA,EAAI,EACxB,KAAOA,GAAcA,GAAK,EAC1B,IAAMA,GAAcA,EAAI,EACxB,KAAOA,GAAcA,GAAK,GAG3B,OADqBQ,EAAYT,IAAeS,EAAY,KACxCR,EAhBqBc,EAOlB,EAPkBA,EAgCWH,EA/BpDE,EAAId,EAD0Bc,EAgCWb,GA9BzCc,EAAIf,EAAiBe,GACdD,EAAEE,cAAcD,OAAA,EAAc,CAAEE,SAAS,KA8BLN,GAA6B,KAAI,GAJ7C,8hBCnChC,SAASO,EAAQC,EAAiBC,GAAsB,IAApBC,OAAEA,EAAS,SAAI,IAAAD,EAAG,CAAA,EAAEA,EACvD,QAASD,GAAaA,EAAUG,WAAWD,EAC5C,CCUA,SAASE,EAAcC,EAAaC,QAAAA,IAAAA,IAAAA,EAA+B,IAClE,MAAMC,EAAMC,MAAMC,KAAKJ,EAAGK,YAC1B,OAAKJ,EAAQK,OAENJ,EAAIK,OAAOC,IAAA,IAACC,KAAEA,GAAMD,EAAA,OAC1BP,EAAQS,KAAMC,GACbA,aAAmBC,OAASD,EAAQE,KAAKJ,GAAQA,IAASE,EAAO,GAJvCT,CAO7B,QChBqB,cAA4BY,EAWhDC,WAAAA,CAAYC,YAAAA,IAAAA,EAA4B,CAAA,GACvCC,QAAQC,KAXTT,KAAO,sBAAqBS,KAE5BC,SAAW,CAAEC,KAAM,SAASF,KAE5BG,SAAoB,CACnBxB,OAAQ,GACRQ,WAAY,IACZa,KACDF,aAWUM,EAAAA,KAAAA,OAAsCC,IAC/C,MAAM1B,OAAEA,EAAMQ,WAAEA,GAAea,KAAKF,SFjCtB,SAAiBhB,EAAiBwB,EAAkBC,GAAE,IAAA5B,OAAEA,EAAS,SAAO,IAAH4B,EAAG,CAAA,EAAEA,EACzF,MAAMC,EAAS,IAAI1B,EAAG2B,WAAWpB,OAAQZ,GAAcD,EAAQC,EAAW,CAAEE,YACtE+B,EAAM,IAAIJ,EAAMG,WAAWpB,OAAQZ,GAAcD,EAAQC,EAAW,CAAEE,YAC5EG,EAAG2B,UAAUD,UAAUA,GACvB1B,EAAG2B,UAAUC,OAAOA,EACrB,CE6BEC,CAAiBC,SAASC,KAAMR,EAAMS,GAAGF,SAAUC,KAAM,CAAElC,WACvDQ,GAAYC,iBDlCjB2B,EACAC,EACAjC,YAAAA,IAAAA,EAA+B,IAE/B,MAAMkC,EAAO,IAAIC,IAEjB,IAAK,MAAM3B,KAAEA,EAAI4B,MAAEA,KAAWtC,EAAcmC,EAAQjC,GACnDgC,EAAOK,aAAa7B,EAAM4B,GAC1BF,EAAKP,IAAInB,GAGV,IAAK,MAAMA,KAAEA,KAAUV,EAAckC,EAAQhC,GACvCkC,EAAKI,IAAI9B,IACbwB,EAAOO,gBAAgB/B,EAG1B,CCmBGgC,CAAiBX,SAASC,KAAMR,EAAMS,GAAGF,SAAUC,KAAM1B,EAC1D,EAZAa,KAAKF,QAAU,IAAKE,KAAKG,YAAaL,EACvC,CAEA0B,KAAAA,GACCxB,KAAKyB,GAAG,kBAAmBzB,KAAKI,OACjC"}